### Computational Methods Version 0.1

## Processing scRNAseq
Raw 10x Genomics scRNA-seq data were imported into Seurat objects per sequencing lane, with sample identities assigned using Demuxalot. Putative doublets were detected using DoubletFinder and removed prior to downstream processing. Lane-level objects were normalized, variable features identified, and merged into a single Seurat object for integration. Batch correction and integration were performed and tested with Seurat’s CCA, RPCA and Harmony. The final object was annotated using Azimuth PBMC reference mapping, clustered, visualized by UMAP, and saved for downstream analyses.

## Processing ATACseq
ATAC-seq data were processed using the ArchR framework, which provides a scalable wrapper for single-cell chromatin accessibility analysis. Raw fragment files were imported into ArchR projects, quality control filters (e.g., TSS enrichment, fragment counts) were applied, and doublets were identified and removed. Dimensionality reduction and clustering were performed within ArchR, followed by peak calling and integration with gene annotations. Motif enrichment and transcription factor activity analyses were carried out using ArchR’s built-in functionality.

## Pathway Enrichment Analysis scRNAseq
Single-cell RNA-seq data were aggregated into pseudobulk expression profiles using Seurat’s AggregateExpression() function, with aggregation performed separately by treatment status (treated vs. untreated), cell type (monaco_ann1 annotation), subject, and sequencing lane to preserve within-subject and technical structure. Nine immune populations were analyzed, including monocytes, T cells, CD4⁺ T cells, CD8⁺ T cells, CD4 TCM, CD8 TCM, NK cells, dendritic cells, and B cells. For each training condition (SYKi, MDP, BG), differential expression between treated and untreated pseudobulk samples was contrasted with the same comparison in the untrained baseline. Genes shared between the two contrasts were used to compute a delta-of-delta log2 fold change, defined as: 
Δlog2FC = (log2FC of Treated vs. Untreated in the Trained condition) − (log2FC of Treated vs. Untreated in the Untrained condition). 
This ranking highlights genes whose treatment response was modified by prior training, beyond baseline differences. Delta-of-delta ranked gene lists were then analyzed using clusterProfiler::GSEA() against a Blood Transcriptional Modules (BTM) gene set, with parameters set to Benjamini–Hochberg correction (pAdjustMethod = "BH"), minimum gene set size = 10, maximum gene set size = 500, and exponent = 1. To compare enrichment across conditions, significantly enriched pathways were compiled per cell type and displayed, and combined diagrams summarized shared and unique pathway enrichments across the three training conditions and the untrained baseline.

## ATAC-seq Associated Gene Pathway Analysis
Pathway enrichment analysis was performed on genes associated with significant ATAC-seq peaks using the clusterProfiler and ReactomePA packages. Peak-gene association files for CD14 monocytes and CD4 TCM cells were filtered using stringent criteria: Log2 fold-change > 1.5, absolute correlation coefficient > 0.3 (positive for correlated, negative for anti-correlated genes). Gene symbols were converted to ENTREZ identifiers using the org.Hs.eg.db annotation package. Reactome pathway enrichment analysis was conducted with p-value cutoff < 0.05, while Gene Ontology (GO) enrichment analysis across all ontologies used Benjamini-Hochberg correction with q-value cutoff. Results were visualized as bar plots for Reactome pathways (top 20 terms) and dot plots for GO enrichment (top 20 terms). Separate analyses were conducted for three experimental conditions (BG, MDP, SYKi) in both cell types, focusing primarily on positively correlated gene sets. Combined multi-panel figures were generated to compare pathway enrichment across conditions and cell types.

## Transcription Factor Family Analysis
Transcription factor (TF) analysis was performed on intersection data derived from UpSet plots. TF names were extracted from intersection files using regular expression pattern matching and mapped to protein families using the CisBP (Catalog of Inferred Sequence Binding Preferences) database. Family counts and percentage distributions were calculated for each intersection and cell type. Multiple visualization approaches were employed: UpSet plots with integrated family annotations, bar charts displaying family counts per cell type, and stacked bar charts showing percentage distributions with labels for the top three most abundant families per condition. Separate analyses were conducted by intersection prefix and individual cell types.

## Feature Plot Analysis
Feature visualization analysis was conducted using Seurat objects containing both module scores and gene expression data. The experimental design included eight conditions representing four training states (untrained, SYKi, MDP, BG) each with treated and untreated PMA stimulation. Module scores were extracted from Seurat metadata columns (ModuleScore*), while individual gene expression data were retrieved from the RNA assay slot. FeaturePlot visualizations were generated for each condition separately, with consistent scaling applied using 95th percentile cutoffs for modules and 99th percentile cutoffs for genes (except GZMB, which used 95th percentile). Violin plots were overlaid to show expression distributions, with median values calculated and displayed. Reference lines were drawn using median values from untrained conditions. Cell type labels were added and final plots combined condition panels and violin summaries.

## Circos Plot Generation
Circular genome visualizations were created using the circlize package in R to display multiple genomic datasets simultaneously. Two complementary analyses were performed: (1) bin-based analysis displaying genome-wide Gene count data (Count_BG, Count_SKYi, Count_MDP) as bar tracks for CD4 TCM and CD14 monocyte cell types, and (2) HIV insertion site analysis combining point data from insertion coordinates, ATAC-seq peak data as vertical line segments, and gene count data as bar plots. Chromosomes were ordered sequentially (chr1-22, X, Y, M) with ideogram initialization. Data tracks maintained consistent y-axis scaling within each dataset type. Manual legends were incorporated to distinguish between data types and experimental conditions. All plots included proper chromosome-level normalization.

## Genome Browser Visualization
Multi-track genome browser visualizations were created to display ATAC-seq and single-cell RNA-seq data aligned to the HIV-1 genome (NC_001802.1). ATAC-seq peak data in BED format were processed to calculate cumulative scores at each genomic position, with separate tracks generated for each training condition (untrained, SYKi, MDP, BG) under PMA-treated conditions. Single-cell RNA-seq data were visualized as stacked gene expression tracks for four HIV genes (HIV1gp1, HIV1gp3, HIV1gp5, HIV1gp8). Gene annotations were extracted from GFF3 files and labeled. All tracks maintained consistent x-axis scaling across the full HIV genome length. Final visualizations were exported in both PDF and SVG formats.
